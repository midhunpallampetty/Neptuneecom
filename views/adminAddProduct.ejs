<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Evara Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">

    <link rel="shortcut icon" type="image/x-icon" href="imgs/theme/favicon.svg">

    <link href="/css2/main.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" integrity="sha384-eiETumQFzuy48lHrO9obg9e8a7+3wF3pSp3yUp0H4V5Z6Yb6UKOqYme7aA8LXdIj" crossorigin="anonymous">
<!-- Include Cropper.js script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js" integrity="sha384-l9k5/KdRf+IkLmlnL49b6eAMh+I1Z5inZIUMYdY22KbxqE0TAF/RBwxjxjGq+tF5" crossorigin="anonymous"></script>
<link rel="stylesheet" href="/admin/css/addproduct.min.css">
 
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" />
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
        

<link
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
rel="stylesheet"
/>

<link
href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
rel="stylesheet"
/>

<link
href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.css"
rel="stylesheet"
/>

<link rel="stylesheet" href="https://unpkg.com/cropperjs/dist/cropper.min.css">

<script src="https://unpkg.com/cropperjs/dist/cropper.min.js"></script>

</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
      <div class="aside-top">
          <a href="index.html" class="brand-wrap">
              <img src="/imgs/logo.png" class="logo" alt="Evara Dashboard">
          </a>
          <div>
              <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
          </div>
      </div>
      <nav>
          <ul class="menu-aside">
              <li class="menu-item active">
                  <a class="menu-link" href="/adminDash"> <i class="icon material-icons md-home"></i>
                      <span class="text">Dashboard</span>
                  </a>
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="page-products-list.html"> <i class="icon material-icons md-shopping_bag"></i>
                      <span class="text">Products</span>
                  </a>
                  <div class="submenu">
                      <a href="/adminAddProduct">Add products</a>
                      <a id="search-link" href="/admin/products">Product Edit and Delete</a>

                   
                  </div>
                  
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="page-orders-1.html"> <i class="icon material-icons md-shopping_cart"></i>
                      <span class="text">Orders</span>
                  </a>
                  <div class="submenu">
                      <a href="page-orders-1.html"></a>
                      
<a href="page-invoice.html">Invoice</a>
                  </div>
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="/admin/userManager"> <i class="icon material-icons md-store"></i>
                      <span class="text">Users</span>
                  </a>
                  <div class="submenu">
                      <a href="/admin/userManager">Block/UnBlock Users</a>
                     
                  </div>
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="/admin/listCategory"> <i class="icon material-icons md-add_box"></i>
                      <span class="text">Categories</span>
                  </a>
                  <div class="submenu">
                      <a href="/category">Manage Categories</a>
                     
                  </div>
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="page-transactions-1.html"> <i class="icon material-icons md-monetization_on"></i>
                      <span class="text">Transactions</span>
                  </a>
                  <div class="submenu">
                      <a href="page-transactions-1.html">Transaction 1</a>
                      <a href="page-transactions-2.html">Transaction 2</a>
                      <a href="page-transactions-details.html">Transaction Details</a>
                  </div>
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="#"> <i class="icon material-icons md-person"></i>
                      <span class="text">Account</span>
                  </a>
                  <div class="submenu">
                      <a href="page-account-login.html">User login</a>
                      <a href="page-account-register.html">User registration</a>
                      <a href="page-error-404.html">Error 404</a>
                  </div>
              </li>
              <li class="menu-item">
                  <a class="menu-link" href="page-reviews.html"> <i class="icon material-icons md-comment"></i>
                      <span class="text">Reviews</span>
                  </a>
              </li>
              <li class="menu-item">
                  <a class="menu-link" href="admin/userManager"> <i class="icon material-icons md-stars"></i>
                      <span class="text">Brands</span> </a>
              </li>
              <li class="menu-item">
                  <a class="menu-link" disabled href="#"> <i class="icon material-icons md-pie_chart"></i>
                      <span class="text">Statistics</span>
                  </a>
              </li>
          </ul>
          <hr>
          <ul class="menu-aside">
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="#"> <i class="icon material-icons md-settings"></i>
                      <span class="text">Settings</span>
                  </a>
                  <div class="submenu">
                      <a href="page-settings-1.html">Setting sample 1</a>
                      <a href="page-settings-2.html">Setting sample 2</a>
                  </div>
              </li>
              <li class="menu-item">
                  <a class="menu-link" href="/logoutAdmin"><svg xmlns="http://www.w3.org/2000/svg" fill="grey" height="1.6em" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M208 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zM123.7 200.5c1-.4 1.9-.8 2.9-1.2l-16.9 63.5c-5.6 21.1-.1 43.6 14.7 59.7l70.7 77.1 22 88.1c4.3 17.1 21.7 27.6 38.8 23.3s27.6-21.7 23.3-38.8l-23-92.1c-1.9-7.8-5.8-14.9-11.2-20.8l-49.5-54 19.3-65.5 9.6 23c4.4 10.6 12.5 19.3 22.8 24.5l26.7 13.3c15.8 7.9 35 1.5 42.9-14.3s1.5-35-14.3-42.9L281 232.7l-15.3-36.8C248.5 154.8 208.3 128 163.7 128c-22.8 0-45.3 4.8-66.1 14l-8 3.5c-32.9 14.6-58.1 42.4-69.4 76.5l-2.6 7.8c-5.6 16.8 3.5 34.9 20.2 40.5s34.9-3.5 40.5-20.2l2.6-7.8c5.7-17.1 18.3-30.9 34.7-38.2l8-3.5zm-30 135.1L68.7 398 9.4 457.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L116.3 441c4.6-4.6 8.2-10.1 10.6-16.1l14.5-36.2-40.7-44.4c-2.5-2.7-4.8-5.6-7-8.6zM550.6 153.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L530.7 224H384c-17.7 0-32 14.3-32 32s14.3 32 32 32H530.7l-25.4 25.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l80-80c12.5-12.5 12.5-32.8 0-45.3l-80-80z"/></svg>&nbsp;
                      <span class="text"> Logout</span>
                  </a>
              </li>
          </ul>
          <br>
          <br>
      </nav>
  </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
          
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    <li class="nav-item">
                     
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i> </a>
                    </li>
                   
                 
                 
                </ul>
            </div>
        </header>
        <section class="content-main">
            <div class="row">
                <div class="col-9">
                    <div class="content-header">
                        <h2 class="content-title">Add New Product</h2>
                        <div>
                            <button class="btn btn-light rounded font-sm mr-5 text-body hover-up">Save to draft</button>
                            <button class="btn btn-md rounded font-sm hover-up">Publich</button>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6" style="width: 100%;">
                    <div class="card mb-4" style="height: 180vh;;">
                       
                        <div class="card-body" style="height: 150vh;">

               
                            
  <form method="POST" action="/admin/products" style="align-items: center; " enctype="multipart/form-data" onsubmit="return validateForm()">
    <div class="mb-1">
      <label for="name" class="form-label">Product title</label>
      <input type="text" name="name" id="name" placeholder="Type here" class="form-control">
      <span class="error-message" id="name-error"></span>
    </div>

    <div class="mb-1">
      <label for="brand" class="form-label">Product Brand</label>
      <input type="text" name="brand" id="brand" placeholder="Type here" class="form-control">
      <span class="error-message" id="brand-error"></span>
    </div>

    <div class="mb-1">
      <label for="description" class="form-label">Description</label>
      <textarea name="description" id="description" placeholder="Type here" class="form-control" rows="2"></textarea>
      <span class="error-message" id="description-error"></span>
    </div>

    <div class="row">
      <div class="col-lg-4">
        <label class="form-label">Category</label>
        <select id="category" name="category" class="form-select">
          <option value="" disabled selected>Select a category</option>
          <!-- Add dynamic options for categories -->
          <% categories.forEach(category => { %>
            <% if (category.listed) { %>
              <option value="<%= category._id %>"><%= category.name %></option>
            <% } %>
          <% }); %>
        </select>
        <span class="error-message" id="category-error"></span>
      </div>
      <div class="col-lg-4">
        <label for="material" class="form-label">Material</label>
        <select id="material" name="material" class="form-select">
          <option value="" disabled selected>Select a material</option>
          <option value="Steel">Steel</option>
          <option value="Wood">Wood</option>
          <option value="Plastic">Plastic</option>
          <option value="Other">Other</option>
        </select>
        <span class="error-message" id="material-error"></span>
      </div>
      <div class="col-lg-4"><label for="color" class="form-label">Color</label>
        <select id="color" name="color" class="form-select">
          <option value="" disabled selected>Select a color</option>
          <option value="Black">Black</option>
          <option value="Green">Green</option>
          <option value="Rainbow">Rainbow</option>
          <option value="Brown">Brown</option>
          <option value="White">White</option>
          <option value="Red">Red</option>
          <option value="Grey">Grey</option>
          <option value="Other">Other</option>
        </select>
        <span class="error-message" id="color-error"></span></div>
    </div>

   
    <div class="row">
      <div class="col-lg-4">
        <label class="form-label">Selling Price</label>
        <input type="number" name="price" id="price" placeholder="$" class="form-control">
        <span class="error-message" id="price-error"></span>
      </div>
      <div class="col-lg-4">
        <label for="weight" class="form-label">Weight</label>
      <input type="text" name="weight" id="weight" placeholder="Enter weight" class="form-control">
      <span class="error-message" id="weight-error"></span>
      </div>
      <div class="col-lg-4"> <label for="listprice" class="form-label">List Price</label>
        <input type="number" name="listprice" id="listprice" placeholder="$" class="form-control">
        <span class="error-message" id="listprice-error"></span>
    </div>
   

   

  

   

    <div class="mb-1">
      <label for="stock" class="form-label">Stock</label>
      <input type="number" name="stock" id="stock" placeholder="Enter stock quantity" class="form-control">
      <span class="error-message" id="stock-error"></span>
    </div>

 

    <div class="card mb-1">
      <div class="input-upload">
        <label for="additionalImages">Additional Product Images (up to 5):</label>
        <input id="additionalImages" name="additionalImages" class="form-control" type="file" accept=".jpg, .jpeg, .png" multiple>
        <span class="error-message" id="additionalImages-error"></span>
      </div>
    </div>
 <!-- Add this inside the form, after the mainImage input -->
<div class="card mb-1">
  <div class="input-upload">
    <label for="mainImage">Main Product Image:</label>
    <input id="mainImage" name="mainImage" class="form-control" type="file" accept=".jpg, .jpeg, .png">
    <span class="error-message" id="mainImage-error"></span>

    <!-- Image cropping section -->
    <div id="cropContainer" style="display: none;width: 500px;height: 350px;">
      <label>Crop Image:</label>
      <div>
        <img id="cropImage" src="" alt="Crop Preview" style="max-width: 60%;">
      </div>
      <button type="button" style="background-color: #007BFF; margin-top:10px;border: none;border-radius: 10px;width: 100px;height: 50px;font-size: medium;" id="applyCrop">Apply Crop</button>
    </div>
  </div>
</div>

    <button type="submit" class="btn  btn-primary">Add Product</button>
  </form>
                              
                              
                              



               
                        </div>
                    </div> <!-- card end// -->
          
                </div>
               
                 
                </div>
            </div>
        </section> 
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> ©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="/js2/vendors/jquery-3.6.0.min.js"></script>
    <script src="/js2/vendors/bootstrap.bundle.min.js"></script>
    <script src="/js2/vendors/select2.min.js"></script>
    <script src="/js2/vendors/perfect-scrollbar.js"></script>
    <script src="/js2/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="/js2/main.js" type="text/javascript"></script>
    <script>
      function validateForm() {
        // Reset error messages
        resetErrorMessages();
    
        // Flag to check if form is valid
        let isValid = true;
    
        // Product title validation
        const name = document.getElementById('name').value.trim();
        if (!/^[a-zA-Z ]+$/.test(name) || /^\d+$/.test(name)) {
          displayError('name', 'Product title should contain only characters and spaces.');
          isValid = false;
        }
    
        // Product brand validation
        const brand = document.getElementById('brand').value.trim();
        if (!/^[a-zA-Z ]+$/.test(brand) || /^\d+$/.test(brand)) {
          displayError('brand', 'Product brand should contain only characters and spaces.');
          isValid = false;
        }
    
        // Description validation
        const description = document.getElementById('description').value.trim();
        if (description.length < 10 || /\s{2,}|\d+|[!@#$%^&*(),.?":{}|<>]/.test(description)) {
          displayError('description', 'Description should be at least 10 characters and contain no numbers or special characters.');
          isValid = false;
        }
    
        // Category validation
        const category = document.getElementById('category').value;
        if (!category) {
          displayError('category', 'Please select a category.');
          isValid = false;
        }
    
        // Selling Price validation
        const price = document.getElementById('price').value.trim();
if (!price || parseFloat(price) <= 0) {
  displayError('price', 'Selling Price must be a positive number.');
  isValid = false;
}
    
        // Material validation
        const material = document.getElementById('material').value;
        if (!material) {
          displayError('material', 'Material must be selected.');
          isValid = false;
        }
    
        // Weight validation
        const weight = document.getElementById('weight').value.trim();
        if (!/^\d+$/.test(weight)) {
          displayError('weight', 'Weight must be provided in numbers only.');
          isValid = false;
        }
    
        // Stock validation
        const stock = document.getElementById('stock').value.trim();
        if (!/^[1-9]\d*$/.test(stock)) {
          displayError('stock', 'Stock quantity must be 1 or greater.');
          isValid = false;
        }
    
        // Color validation
        const color = document.getElementById('color').value;
        if (!color) {
          displayError('color', 'Please select a color.');
          isValid = false;
        }
    
        // List Price validation
     // List Price validation
const listPrice = document.getElementById('listprice').value.trim();
if (!listPrice || parseFloat(listPrice) <= 0) {
  displayError('listprice', 'List Price must be a positive number.');
  isValid = false;
}

    
        // Main Image validation
        const mainImage = document.getElementById('mainImage').value.trim();
        if (!/\.(png|jpg|gif|webp)$/.test(mainImage.toLowerCase())) {
          displayError('mainImage', 'Main Product Image must be in PNG, JPG, GIF, or WEBP format.');
          isValid = false;
        }
    
        // Additional Images validation
        const additionalImages = document.getElementById('additionalImages').files;
        for (const file of additionalImages) {
          if (!/\.(png|jpg|gif|webp)$/.test(file.name.toLowerCase())) {
            displayError('additionalImages', 'Additional Product Images must be in PNG, JPG, GIF, or WEBP format.');
            isValid = false;
            break;
          }
        }
    
        // Submit the form if it's valid
        return isValid;
      }
    
      // Helper function to display error messages
      function displayError(field, message) {
        document.getElementById(`${field}-error`).innerText = message;
        setTimeout(() => {
          resetErrorMessages();
        }, 5000);
      }
    
      // Helper function to reset error messages
      function resetErrorMessages() {
        const errorMessages = document.getElementsByClassName('error-message');
        for (const errorMessage of errorMessages) {
          errorMessage.innerText = '';
        }
      }
    </script>
     
     <script>
      document.addEventListener('DOMContentLoaded', function () {
  const input = document.getElementById('mainImage');
  const image = document.getElementById('cropImage');
  const container = document.getElementById('cropContainer');
  const applyCropBtn = document.getElementById('applyCrop');
  let cropper;

  input.addEventListener('change', function () {
    const file = this.files[0];

    if (file) {
      // Destroy the existing Cropper instance if it exists
      if (cropper) {
        cropper.destroy();
      }

      const reader = new FileReader();

      reader.onload = function (e) {
        image.src = e.target.result;
        container.style.display = 'block';

        // Initialize Cropper.js
        cropper = new Cropper(image, {
          aspectRatio: 1.3, // Set your desired aspect ratio
          viewMode: 2,    // Set your desired view mode
          scalable: true,
          zoomable: true,
        });
      };

      reader.readAsDataURL(file);
    }
  });

  applyCropBtn.addEventListener('click', function () {
    if (cropper) {
      // Get the cropped data (base64 format)
      const croppedData = cropper.getCroppedCanvas().toDataURL();

      // Clear previous hidden input
      const previousHiddenInput = document.getElementById('croppedImage');
      if (previousHiddenInput) {
        previousHiddenInput.remove();
      }

      // Add a new hidden input with the cropped data
      const hiddenInput = document.createElement('input');
      hiddenInput.type = 'hidden';
      hiddenInput.id = 'croppedImage';
      hiddenInput.name = 'croppedImage';
      hiddenInput.value = croppedData;
      document.getElementById('cropContainer').appendChild(hiddenInput);

      // You can also update the mainImage input value if needed
      // document.getElementById('mainImage').value = croppedData;

      // Hide the crop container
      container.style.display = 'none';
    }
  });
});

    </script>
    
</body>

</html>